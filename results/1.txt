(myenv01) brucebi@user-5090-512:~/Projects/REIN-LLM-Forecast$ bash scripts/nswelecprice/elecpricerun2.sh
==> Running: [DeltaWithNews]NSW_2015_2020
[live log] ./checkpoints/[DeltaWithNews]NSW_2015_2020/[DeltaWithNews]NSW_2015_2020_news_V0_Watt_Summarized_news_2015_2020.json_basefrac_0.4_epochs_50_lookback_1_topK_999.log  (实时查看: tail -f './checkpoints/[DeltaWithNews]NSW_2015_2020/[DeltaWithNews]NSW_2015_2020_news_V0_Watt_Summarized_news_2015_2020.json_basefrac_0.4_epochs_50_lookback_1_topK_999.log')
torch version: 2.9.1+cu128
compiled with CUDA: 12.8
cuda.is_available: True
cuda device count: 2
12.8
Using GPU id: 0
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 227.81it/s]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
The new lm_head weights will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
trainable params: 19,660,800 || all params: 8,049,930,240 || trainable%: 0.24423565687943155
using mlp
[BASE] Epoch 1/20: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:28<00:00, 10.32it/s, train_loss=0.058271]
/home/brucebi/miniconda3/envs/myenv01/lib/python3.10/site-packages/peft/utils/save_and_load.py:168: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[BASE] Epoch 2/20: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.38it/s, train_loss=0.056240]
/home/brucebi/miniconda3/envs/myenv01/lib/python3.10/site-packages/peft/utils/save_and_load.py:168: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[BASE] Epoch 3/20: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.38it/s, train_loss=0.051370]
/home/brucebi/miniconda3/envs/myenv01/lib/python3.10/site-packages/peft/utils/save_and_load.py:168: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[BASE] Epoch 4/20: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.37it/s, train_loss=0.049626]
/home/brucebi/miniconda3/envs/myenv01/lib/python3.10/site-packages/peft/utils/save_and_load.py:168: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[BASE] Epoch 5/20: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.36it/s, train_loss=0.049680]
/home/brucebi/miniconda3/envs/myenv01/lib/python3.10/site-packages/peft/utils/save_and_load.py:168: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[BASE] Epoch 6/20: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.38it/s, train_loss=0.050288]
/home/brucebi/miniconda3/envs/myenv01/lib/python3.10/site-packages/peft/utils/save_and_load.py:168: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[BASE] Epoch 7/20: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.37it/s, train_loss=0.052783]
/home/brucebi/miniconda3/envs/myenv01/lib/python3.10/site-packages/peft/utils/save_and_load.py:168: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[BASE] Epoch 8/20: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.37it/s, train_loss=0.058601]
/home/brucebi/miniconda3/envs/myenv01/lib/python3.10/site-packages/peft/utils/save_and_load.py:168: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[BASE] Epoch 9/20: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.38it/s, train_loss=0.044716]
/home/brucebi/miniconda3/envs/myenv01/lib/python3.10/site-packages/peft/utils/save_and_load.py:168: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[BASE] Epoch 10/20: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.36it/s, train_loss=0.054685]
[BASE] Epoch 11/20: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.37it/s, train_loss=0.046115]
/home/brucebi/miniconda3/envs/myenv01/lib/python3.10/site-packages/peft/utils/save_and_load.py:168: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[BASE] Epoch 12/20: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.38it/s, train_loss=0.057615]
/home/brucebi/miniconda3/envs/myenv01/lib/python3.10/site-packages/peft/utils/save_and_load.py:168: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[BASE] Epoch 13/20: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.36it/s, train_loss=0.079490]
[BASE] Epoch 14/20: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.36it/s, train_loss=0.070846]
/home/brucebi/miniconda3/envs/myenv01/lib/python3.10/site-packages/peft/utils/save_and_load.py:168: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[BASE] Epoch 15/20: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.37it/s, train_loss=0.047555]
[BASE] Epoch 16/20: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.36it/s, train_loss=0.045642]
[BASE] Epoch 17/20: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.36it/s, train_loss=0.049762]
[BASE] Epoch 18/20: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.38it/s, train_loss=0.081390]
[BASE] Epoch 19/20: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.36it/s, train_loss=0.051519]
[BASE] Epoch 20/20: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [02:27<00:00, 10.36it/s, train_loss=0.048157]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:01<00:00,  3.32it/s]
using mlp
[DELTA] Epoch 1/30: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [03:58<00:00,  6.44it/s, train_loss=0.049001]
/home/brucebi/miniconda3/envs/myenv01/lib/python3.10/site-packages/peft/utils/save_and_load.py:168: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[DELTA] Epoch 2/30: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [03:57<00:00,  6.45it/s, train_loss=0.051287]
/home/brucebi/miniconda3/envs/myenv01/lib/python3.10/site-packages/peft/utils/save_and_load.py:168: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[DELTA] Epoch 3/30: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [03:57<00:00,  6.45it/s, train_loss=0.060350]
/home/brucebi/miniconda3/envs/myenv01/lib/python3.10/site-packages/peft/utils/save_and_load.py:168: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[DELTA] Epoch 4/30: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [03:57<00:00,  6.45it/s, train_loss=0.059718]
[DELTA] Epoch 5/30: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [03:57<00:00,  6.45it/s, train_loss=0.048152]
[DELTA] Epoch 6/30: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [03:57<00:00,  6.45it/s, train_loss=0.043120]
[DELTA] Epoch 7/30: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [03:57<00:00,  6.45it/s, train_loss=0.040668]
[DELTA] Epoch 8/30: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [03:57<00:00,  6.45it/s, train_loss=0.040625]
[DELTA] Epoch 9/30: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1533/1533 [03:57<00:00,  6.45it/s, train_loss=0.042900]
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:01<00:00,  3.31it/s]
using mlp
[TEST][FINAL] loss(zMSE)=1.212844 mse(raw)=93236.502923 mae(raw)=31.316838